(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{449:function(s,n,a){"use strict";a.r(n);var e=a(28),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("环境：")]),s._v(" "),a("ul",[a("li",[s._v("centos7.3")]),s._v(" "),a("li",[s._v("docker --version: 17.12.0-ce")])]),s._v(" "),a("p",[s._v("官方镜像："),a("a",{attrs:{href:"https://hub.docker.com/_/mysql",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/_/mysql"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("官方Github: "),a("a",{attrs:{href:"https://github.com/docker-library/mysql/blob/4af273a07854d7e4b68c5148b8e23b86aa8706e2/8.0/Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/docker-library/mysql/blob/4af273a07854d7e4b68c5148b8e23b86aa8706e2/8.0/Dockerfile"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('1. 操作系统切换到root用户：\n# su root\n\n2. 启动docker\n# systemctl start docker\n\n3. 拉取mysql8.0镜像\n# docker pull mysql:8.0\n\n4. 创建并启动容器\n-p: 映射本地端口3306\n--restart-always: docker服务启动时，自动启动容器，并且当容器停止时，尝试重启容器。\n--restart具体参数值详细信息：\n    no -  容器退出时，不重启容器；\n    on-failure - 只有在非0状态退出时才从新启动容器；\n    always - 无论退出状态是如何，都重启容器；\n\nMYSQL_ROOT_PASSWORD：设置root密码为root\n\n设置默认数据库编码为utf8mb4,默认排序规则为utf8mb4_unicode_ci\n\n -v : 挂载本地卷\n\n注意：mysql8.0安装默认编码为utf8mb4，所以可以不需要参数--character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci\n\ndocker run \\\n--name mysql \\\n-p 3306:3306 \\\n--restart=always \\\n-e MYSQL_ROOT_PASSWORD=root \\\n-v /var/lib/mysql/:/var/lib/mysql/ \\\n-d mysql:8.0 \\\n--character-set-server=utf8mb4 \\\n--collation-server=utf8mb4_unicode_ci\n\n5. 进入docker的mysql容器\n #  docker exec -it mysql /bin/bash\n\n6. 登录数据库（此处的密码为参数-e MYSQL_ROOT_PASSWORD=root对应的值，此处密码为root）\n#  mysql -uroot -proot\n\n7. 使用mysql数据库\nmysql> use mysql；\n\n8. mysql8.0的root用户的验证方式变了，通过查询：select host,user,plugin from user;\n\n得知：root的用户的加密方式为caching_sha2_passoword, 而navicat连接所用的方式为native_password。mysql为远程连接和本地连接提供了不同的密码验证方式。\n\n修改root用户插件验证方式：\n\nmysql> ALTER USER \'root\'@\'%\' IDENTIFIED WITH mysql_native_password BY \'root\';\n\n注意:先更改ser表中用户为root的host字段，若为localhost则改为%，只有改为%，该用户才可以远程访问。\n\n此时，可以使用mysql客户端工具连接数据库。\n\n如果navicat 提示“1045 access denied for user \'root\'@\'localhost\' ”，则执行：\n\nmysql> alter user \'root\'@\'localhost\' identified by \'root\';\n\n同理：如果navicat 提示“1045 access denied for user \'root\'@\'%\' ”，则执行：\n\nmysql> alter user \'root\'@\'%\' identified by \'root\';\n\n刷新权限：\n\nmysql> flush privileges;\n\n9. 修改mysql数据库编码，防止中文乱码\n\n（1）进入docker的mysql容器\n     #  docker exec -it mysql /bin/bash\n\n（2）容器默认没有安装任何编辑器，先安装vim。\n     #  apt-get update && apt-get install vim -y\n\n (3)  安装完vim之后，开始修改mysql数据库编码\n\n     #  vim /etc/mysql/conf.d/mysql.cnf\n\n增加以下内容，然后保存，退出：      \n\n[client]\ndefault-character-set=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n (4)  重启mysql容器，查询编码：此时编码已经修改为utf8。\n    mysql>  show variables like\'character%\';\n\n10.  查看挂载卷位置：获取容器/镜像的元数据。\n    #  docker inspect  容器ID\n\n其中：\n    "Mounts": [\n        {\n            "Type": "volume",\n            "Name": "ebc0e8f50d451650f29d7ac1a696a0130316073173835c1b5c9f7f88c5fb976f",\n            "Source": "/var/lib/docker/volumes/ebc0e8f50d451650f29d7ac1a696a0130316073173835c1b5c9f7/_data",\n            "Destination": "/var/lib/mysql",\n            "Driver": "local",\n            "Mode": "",\n            "RW": true,\n            "Propagation": ""\n        }\n    ]\n\nSource：为本地主机挂载卷的路径\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);