(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{450:function(s,t,n){"use strict";n.r(t);var a=n(28),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("Windows 10 开启子系统后，在应用商店安装 Ubuntu。")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载旧版本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" remove docker docker-engine docker.io containerd runc\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 官方源太慢了，这里使用 aliyun 的源来安装")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# apt-get 可以使用https库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y apt-transport-https ca-certificates "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" software-properties-common\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加docker的使用的公钥")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加docker的远程库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" add-apt-repository "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu '),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release -cs"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(' stable"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装docker-ce")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 docker（检查 docker 安装成功：docker version）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" docker start\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 docker 开机自动启动 （启动之前先安装 sysv-rc-conf）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" sysv-rc-conf docker on\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" sysv-rc-conf containerd.service on\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("这个 Ubuntu 中没有 systemctl 命令来启动 docker, 取而代之的是 经典的SysV init（sysvinit）系统。")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"left"}},[s._v("Systemd command")]),s._v(" "),n("th",{staticStyle:{"text-align":"left"}},[s._v("Sysvinit command")])])]),s._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl start ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("service ServiceName start")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl stop ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("service ServiceName stop")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl restart ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("service ServiceName restart")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl status ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("service ServiceName status")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl enable ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("chkconfig ServiceName on")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("systemctl disable ServiceName")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("chkconfig ServiceName off")])])])]),s._v(" "),n("h3",{attrs:{id:"安装-sysv-rc-conf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-sysv-rc-conf"}},[s._v("#")]),s._v(" 安装 sysv-rc-conf")]),s._v(" "),n("p",[s._v("在这个 ubuntu 版本中，使用 sysv-rc-conf 来代替 chkconfig，所以使用之前需要先安装 sysv-rc-config。\n对应上面的命令就变成了：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("sysv-rc-conf ServiceName on\nsysv-rc-conf ServiceName off\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("在ubuntu-18.04.3版本，安装sysv-rc-conf时，报了如下的错：E: Unable to locate package sysv-rc-conf（无法定位sysv-rc-conf包）。解决方法如下：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开sources.list文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/apt/sources.list\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在sources.list文件最后一行中添加如下一列文本")]),s._v("\ndeb http://archive.ubuntu.com/ubuntu/ trusty main universe restricted multiverse\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" sysv-rc-conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"以非-root-用户管理-docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#以非-root-用户管理-docker"}},[s._v("#")]),s._v(" 以非 root 用户管理 Docker")]),s._v(" "),n("p",[s._v("安装到上面的步骤后，就已经完成了安装，但是，此时启动，停止 docker 都只能在命令前面添加 sudo 或者使用 root 用户，太麻烦了，所以有以下步骤可选：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建docker组。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" docker\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将您的用户添加到docker组中。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -aG docker "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注销并重新登录，以便重新评估您的组成员身份。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果在虚拟机上进行测试，可能需要重新启动虚拟机以使更改生效。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在桌面 Linux 环境（如 X Windows）上，完全注销会话，然后重新登录。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 Linux 上，您还可以运行以下命令来激活对组的更改：")]),s._v("\nnewgrp docker\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证您是否可以在docker没有sudo（命令前面不要加 sudo）")]),s._v("\ndocker run hello-world\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此命令下载测试映像并在容器中运行它。当容器运行时，它会打印一条消息并退出。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果您sudo在将用户添加到docker组之前最初运行 Docker CLI 命令，您可能会看到以下错误，这表明您的~/.docker/目录由于sudo命令而使用不正确的权限创建。")]),s._v("\nWARNING: Error loading config file: /home/user/.docker/config.json -\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" /home/user/.docker/config.json: permission denied\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要解决此问题，请删除~/.docker/目录（它会自动重新创建，但所有自定义设置都将丢失），或使用以下命令更改其所有权和权限：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),s._v(" /home/"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v('"')]),s._v("/.docker -R\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" g+rwx "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v('/.docker"')]),s._v(" -R\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h3",{attrs:{id:"配置-aliyun-镜像加速器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-aliyun-镜像加速器"}},[s._v("#")]),s._v(" 配置 aliyun 镜像加速器")]),s._v(" "),n("p",[s._v("针对Docker客户端版本大于 1.10.0 的用户")]),s._v(" "),n("p",[s._v("您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://bfflggen.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sudo systemctl daemon-reload")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sudo systemctl restart docker")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后，重启电脑，重启虚拟机，重启 docker （因为上面的 systemctl 无法使用）")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);