(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{573:function(s,e,n){"use strict";n.r(e);var a=n(28),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("vue-cli 参考文档："),n("a",{attrs:{href:"https://cli.vuejs.org/zh/guide/cli-service.html#vue-cli-service-build",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cli.vuejs.org/zh/guide/cli-service.html#vue-cli-service-build"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"package-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#package-json"}},[s._v("#")]),s._v(" package.json")]),s._v(" "),n("p",[s._v("假如你有这样一个 package.json 文件：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service serve"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build:prod"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面这个 build:prod 和下面的一样，不写的话默认就是 --mode production")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#"build:prod": "SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build --mode production",')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preview"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/index.js --preview"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lint"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --ext .js,.vue src"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("假如你有这样一个 .env.production 环境配置文件")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("VUE_APP_TITLE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 应用标题\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有可能你的 .env.production 里面没有写 NODE_ENV = production 这一项")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为 vue-cli-service build 默认等价于 vue-cli-service build --mode production")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 而 NODE_ENV 默认也就是 production")]),s._v("\nNODE_ENV "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" production\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台接口前缀（nginx 代理的时候需要这个路径）")]),s._v("\nVUE_APP_BASE_API "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/prod-api'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 前端应用访问根路径。例如使用前缀 /admin/，前端访问的时候就是 http://localhost:80/admin/index.html")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个影响 ajax 或项目中使用到 base_path 的地方，一般都是定义一个 VUE_APP_CONTEXT_PATH 变量然后在各处引用，这样就可以随意修改了。")]),s._v("\nVUE_APP_CONTEXT_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("你想打包一个使用 .env.development 环境的发布包部署到 nginx 子目录中，你需要做以下修改：")]),s._v(" "),n("h4",{attrs:{id:"_1、package-json-增加下面的-script-指定-mode-为-development"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、package-json-增加下面的-script-指定-mode-为-development"}},[s._v("#")]),s._v(" 1、package.json 增加下面的 script，指定 --mode 为 development")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build:dev"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build --mode development"')]),s._v(",\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 完整 scripts 如下：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service serve"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build:dev"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build --mode development"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build:prod"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面这个 build:prod 和下面的一样，不写的话默认就是 --mode production")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#"build:prod": "SET NODE_OPTIONS=--openssl-legacy-provider && vue-cli-service build --mode production",')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preview"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build/index.js --preview"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lint"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --ext .js,.vue src"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h4",{attrs:{id:"_2、-env-development-内容如下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、-env-development-内容如下"}},[s._v("#")]),s._v(" 2、.env.development 内容如下")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("VUE_APP_TITLE "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 应用标题\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定为生产环境配置（这个必须配置为 NODE_ENV = production，如果没有这项配置，则需要新增加)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 否则打包就不是可以放到 nginx 下代理的期待包，有可能缺失 src 下自己写的 vue 组件。")]),s._v("\nNODE_ENV "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" production\n\nVUE_APP_BASE_API "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev-api'")]),s._v("\n\nVUE_APP_CONTEXT_PATH "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev/'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"打包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包"}},[s._v("#")]),s._v(" 打包")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build:dev\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);