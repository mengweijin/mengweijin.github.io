(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{455:function(s,a,n){"use strict";n.r(a);var e=n(28),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("环境：")]),s._v(" "),n("ul",[n("li",[s._v("centos7")]),s._v(" "),n("li",[s._v("docker --version: 20.12.0-ce")])]),s._v(" "),n("h3",{attrs:{id:"参考文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),n("ol",[n("li",[s._v("官方构建文档："),n("a",{attrs:{href:"https://github.com/oracle/docker-images/blob/main/OracleDatabase/SingleInstance/README.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/oracle/docker-images/blob/main/OracleDatabase/SingleInstance/README.md"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("三方构建文档："),n("a",{attrs:{href:"https://blog.51cto.com/u_1472521/5116607",target:"_blank",rel:"noopener noreferrer"}},[s._v("Oracle Docker 镜像（制作）"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("三方构建文档："),n("a",{attrs:{href:"https://www.cnblogs.com/atuotuo/p/6999833.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker- 构建 oracle2c-r2(12.2.0.1) 的镜像"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),n("ol",[n("li",[s._v("下载 oracle 12c R2(12.2.0.1.0) linux x64 压缩包："),n("a",{attrs:{href:"https://blog.csdn.net/wupanlong_1992/article/details/128171333",target:"_blank",rel:"noopener noreferrer"}},[s._v("Oracle 11g 12C等旧版-下载总结"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("下载 oracle 官方 github 上的构建包脚本压缩包："),n("a",{attrs:{href:"https://github.com/oracle/docker-images",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/oracle/docker-images"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("下载好的压缩包为：")]),s._v(" "),n("div",{staticClass:"language-txt line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-txt"}},[n("code",[s._v("docker-images-main.zip\nlinuxx64_12201_database.zip \n\n# --------------------------------------------------------------\n# 此数据库安装包必须命名为这样的格式：linuxx64_<version>_database.zip （可查看 github 上官方构建文档）\n# 当前安装包版本：12.2.0.1.0\n# 按照 docker-images-main.zip 中的目录层级，版本号没有最后一个 0\n# 所以命名为 linuxx64_12201_database.zip \n\n# 注意：19.3.0.0.0 版本的命名规则与 12 的版本不一样\n# 19.3.0.0.0 版本应该命名为：LINUX.X64_193000_db_home.zip\n\n# 提示，运行 ./buildContainerImage.sh -v 19.3.0 -e 命令时，可根据报错信息来修正命名。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("ol",[n("li",[s._v("将以上两个压缩包复制到装有 docker 的 linux 主机上，并解压缩 docker-images-main.zip\n"),n("ol",[n("li",[n("strong",[s._v("unzip docker-images-main.zip")])])])]),s._v(" "),n("li",[s._v("将 linuxx64_12201_database.zip 安装包移动到上一步解压缩后的指定文件夹下：\n"),n("ol",[n("li",[s._v("docker-images-main/OracleDatabase/SingleInstance/dockerfiles/12.2.0.1/"),n("strong",[s._v("linuxx64_12201_database.zip")])])])])]),s._v(" "),n("p",[n("strong",[s._v("提示")]),s._v("：如果从 oracle 官方下载的安装包是两个压缩包，则需要命名两个压缩包。比如 12C R1(12.1.0.2) 版本，需要分别命名为：")]),s._v(" "),n("ul",[n("li",[s._v("linuxamd64_12102_database_1of2.zip")]),s._v(" "),n("li",[s._v("linuxamd64_12102_database_2of2.zip")])]),s._v(" "),n("h3",{attrs:{id:"构建docker镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建docker镜像"}},[s._v("#")]),s._v(" 构建DOCKER镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入 buildContainerImage.sh 脚本所在目录")]),s._v("\n$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/docker-images/OracleDatabase/SingleInstance/dockerfiles \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行脚本构建（-v：指定镜像版本；-e：构建企业版）")]),s._v("\n$ ./buildContainerImage.sh -v "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1 -e\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后就是半小时漫长等待（取决于网络）")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("直到出现如下信息，则构建成功：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("Step "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/22 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ORACLE_BASE")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RUN_FILE")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" fbb1bb03ac4f\nRemoving intermediate container fbb1bb03ac4f\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5d4779f2076c\nSuccessfully built 5d4779f2076c\nSuccessfully tagged oracle/database:12.2.0.1-ee\n\n  Oracle Database container image "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ee'")]),s._v(" version "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1 is ready to be extended:\n\n    --"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" oracle/database:12.2.0.1-ee\n\n  Build completed "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1910")]),s._v(" seconds.\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h5",{attrs:{id:"构建完成后-查看镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建完成后-查看镜像"}},[s._v("#")]),s._v(" 构建完成后，查看镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY       TAG          IMAGE ID       CREATED         SIZE\noracle/database  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1-ee  5d4779f2076c   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".15GB\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h4",{attrs:{id:"推送到-docker-hub"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#推送到-docker-hub"}},[s._v("#")]),s._v(" 推送到 docker hub")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录 docker hub")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker login")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后根据提示输入用户名和密码")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打镜像 tag。将镜像 oracle/database:12.2.0.1-ee 标记为 mengweijin/oracle:12.2.0.1-ee 镜像。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker tag oracle/database:12.2.0.1-ee mengweijin/oracle:12.2.0.1-ee")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY         TAG          IMAGE ID       CREATED          SIZE\nmengweijin/oracle  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1-ee  5d4779f2076c   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".15GB\noracle/database    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1-ee  5d4779f2076c   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" minutes ago   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(".15GB\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传本地镜像 mengweijin/oracle:12.2.0.1-ee 到镜像仓库中。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ls dockerfiles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push mengweijin/oracle:12.2.0.1-ee")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h4",{attrs:{id:"启动容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker pull mengweijin/oracle:12.2.0.1-ee\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意：如果挂载卷，可能需要给本地物理机挂载的文件夹授权 775")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比如：chmod -R a+w /opt/oracle/oradata")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 否则容器第一次启动初始化会没有权限而报错。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不挂载卷则没有这个问题。")]),s._v("\n\ndocker run --name oracle12c "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),s._v(":1521 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5500")]),s._v(":5500 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ORACLE_SID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ORCLCDB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ORACLE_PDB")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ORCLPDB "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ORACLE_PWD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("host "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" point"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("/opt/oracle/oradata "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d mengweijin/oracle:12.2.0.1-ee\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看安装日志")]),s._v("\ndocker logs -ft oracle12c\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等待安装完成一直到 100% complete，请耐心等待......")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it oracle12c /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h4",{attrs:{id:"sqlplus-连接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sqlplus-连接"}},[s._v("#")]),s._v(" sqlplus 连接")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it oracle12c /bin/bash\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录sqlplus（如果不是docker，可以用终端或命令提示符使用 sqlplus）")]),s._v("\n sql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sqlplus /nolog\n sql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" connect /as sysdba\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后就可以做任何想做的事情了，比如修改密码永不过期、创建用户等操作")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h4",{attrs:{id:"客户端连接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端连接"}},[s._v("#")]),s._v(" 客户端连接")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SID和服务名: ORCLCDB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jdbc url: jdbc:oracle:thin:@//localhost:1521/ORCLCDB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户名：SYS, SYSTEM and PDB_ADMIN ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码: 123456")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h4",{attrs:{id:"修改密码永不过期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改密码永不过期"}},[s._v("#")]),s._v(" 修改密码永不过期")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用 SYS 用户登录系统后：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过如下sql查询所用用户密码有效期配置。查询结果一般为：DEFAULT")]),s._v("\nSql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username, PROFILE FROM dba_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询配置文件中的有效期参数（dba_profiles）默认 LIMIT=180")]),s._v("\nSql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SELECT * FROM dba_profiles WHERE profile "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DEFAULT'")]),s._v(" AND resource_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PASSWORD_LIFE_TIME'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Oracle所有用户密码的有效期时间（dba_users）")]),s._v("\nSql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SELECT username, account_status, expiry_date FROM dba_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将默认的有效期改成无限期")]),s._v("\nSql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查询发现 LIMIT=UNLIMITED 了")]),s._v("\nSql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SELECT * FROM dba_profiles WHERE profile "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DEFAULT'")]),s._v(" AND resource_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PASSWORD_LIFE_TIME'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h4",{attrs:{id:"创建用户"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建用户"}},[s._v("#")]),s._v(" 创建用户")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建用户，Oracle 12c 创建用户需要添加 C## ：jdbc 连接的时候同样需要 C##")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果客户端批量执行创建和授权语句报错的话，则需要一条一条的执行。")]),s._v("\ncreate user C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('##TEST identified by "1qaz2wsx";')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一般情况下，在新建数据库用户后，都会习惯性的给用户授权CONNECT角色和RESOURCE角色。")]),s._v("\ngrant "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CONNECT"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RESOURCE"')]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C##TEST"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果 Oracle 报 ORA-01950 错误，则需要下面表空间授权：")]),s._v("\nGRANT UNLIMITED TABLESPACE TO C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##TEST;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##TEST QUOTA UNLIMITED ON USERS;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果需要 DBA 权限，则授予 DBA 角色")]),s._v("\ngrant "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DBA"')]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C##TEST"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除用户")]),s._v("\ndrop user C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##TEST cascade;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改密码 ")]),s._v("\nALTER user C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('##TEST identified by "1qaz2wsx";')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h3",{attrs:{id:"用户角色和授权"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户角色和授权"}},[s._v("#")]),s._v(" 用户角色和授权")]),s._v(" "),n("p",[s._v("Oracle 数据库拥有三个标准的角色：CONNECT、RESOURCE、DBA")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("CONNECT")]),s._v(" 角色：是授予最终用户的典型权利，最基本的权力，能够连接到ORACLE数据库中，并在对其他用户的表有访问权限时，做SELECT、UPDATE、INSERT 等操作。\n"),n("ul",[n("li",[s._v("ALTER SESSION           --修改会话")]),s._v(" "),n("li",[s._v("CREATE CLUSTER          --建立聚簇")]),s._v(" "),n("li",[s._v("CREATE DATABASE LINK    --建立数据库链接")]),s._v(" "),n("li",[s._v("CREATE SEQUENCE         --建立序列")]),s._v(" "),n("li",[s._v("CREATE SESSION          --建立会话")]),s._v(" "),n("li",[s._v("CREATE SYNONYM          --建立同义词")]),s._v(" "),n("li",[s._v("CREATE VIEW             --建立视图")])])]),s._v(" "),n("li",[n("strong",[s._v("RESOURCE")]),s._v(" 角色：是授予开发人员的，能在自己的方案中创建表、序列、视图等。\n"),n("ul",[n("li",[s._v("CREATE CLUSTER          --建立聚簇")]),s._v(" "),n("li",[s._v("CREATE PROCEDURE        --建立过程")]),s._v(" "),n("li",[s._v("CREATE SEQUENCE         --建立序列")]),s._v(" "),n("li",[s._v("CREATE TABLE            --建表")]),s._v(" "),n("li",[s._v("CREATE TRIGGER          --建立触发器")]),s._v(" "),n("li",[s._v("CREATE TYPE             --建立类型")])])]),s._v(" "),n("li",[n("strong",[s._v("DBA")]),s._v(" 角色：是授予系统管理员的，拥有该角色的用户就能成为系统管理员了，它拥有所有的系统权限。")])]),s._v(" "),n("p",[s._v("一般情况下，在新建数据库用户后，都会习惯性的给用户授权CONNECT角色和RESOURCE角色。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("create user C"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('##TEST identified by "1qaz2wsx";')]),s._v("\n\ngrant "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CONNECT"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RESOURCE"')]),s._v(" to "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C##TEST"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"重启容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重启容器"}},[s._v("#")]),s._v(" 重启容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker stop oracle12c\ndocker start oracle12c\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"备注说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备注说明"}},[s._v("#")]),s._v(" 备注说明")]),s._v(" "),n("p",[s._v("非 docker 安装的 oracle，通过客户端工具连接时，可能遇到这些问题：")]),s._v(" "),n("h4",{attrs:{id:"sqlplus-可以连接-但客户端工具无法使用-sys-用户连接-ora-12541"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sqlplus-可以连接-但客户端工具无法使用-sys-用户连接-ora-12541"}},[s._v("#")]),s._v(" sqlplus 可以连接，但客户端工具无法使用 SYS 用户连接 ORA-12541")]),s._v(" "),n("p",[s._v("ORA-12541: Cannot connect. No listener at host 192.168.188.141 port 1521. (CONNECTION_ID=YWFMDX8WQVqJpeOreyFc4w==)")]),s._v(" "),n("p",[s._v("ORA-12541: TNS: 无监听程序")]),s._v(" "),n("p",[s._v("使用 oracle 服务器上的 net configuration assistant 工具重新配置【监听程序配置】和【本地网络服务名配置】。")]),s._v(" "),n("p",[s._v("配置【监听程序配置】时，选择：")]),s._v(" "),n("ul",[n("li",[s._v("【重新配置】")]),s._v(" "),n("li",[s._v("【LISTENER】")]),s._v(" "),n("li",[s._v("【TCP】")]),s._v(" "),n("li",[s._v("【1521】")])]),s._v(" "),n("p",[s._v("配置【本地网络服务名配置】时，选择：")]),s._v(" "),n("ul",[n("li",[s._v("【重新配置】")]),s._v(" "),n("li",[s._v("服务名选择【ORCL】（根据自己实际情况）")]),s._v(" "),n("li",[s._v("【TCP】")]),s._v(" "),n("li",[s._v("主机名写 ip 地址【192.168.1.100】")]),s._v(" "),n("li",[s._v("【1521】")]),s._v(" "),n("li",[s._v("【是，进行测试】")]),s._v(" "),n("li",[s._v("【更改登录】修改用户名和密码为自己创建的普通角色的用户。")]),s._v(" "),n("li",[s._v("提示测试成功，则完成配置。")])]),s._v(" "),n("h4",{attrs:{id:"创建的新用户无法登录-ora-01017"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建的新用户无法登录-ora-01017"}},[s._v("#")]),s._v(" 创建的新用户无法登录 ORA-01017")]),s._v(" "),n("p",[s._v("ORA-01017: invalid username/password; logon denied")]),s._v(" "),n("p",[s._v("检查客户端工具是不是【角色】没有选【Normal】")])])}),[],!1,null,null,null);a.default=t.exports}}]);