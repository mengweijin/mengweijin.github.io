(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{461:function(s,a,n){"use strict";n.r(a);var t=n(28),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("Docker镜像的导入导出，用于迁移、备份、升级等场景。涉及的命令有 save、load、export、import，分为2类，一个是拷贝容器，一个是拷贝镜像，不要混用。")]),s._v(" "),n("ul",[n("li",[s._v("镜像导入是一个复制的过程；容器的导入是将当前容器变成一个新的镜像；")]),s._v(" "),n("li",[s._v("docker save命令保存的是镜像；docker export命令保存的是容器；")]),s._v(" "),n("li",[s._v("export命令导出的tar文件略小于save命令导出的；")]),s._v(" "),n("li",[s._v("export命令导出的是容器，export导出的文件在import导入时，无法保留镜像的所有历史（即每一层layer信息），也就不能进行回滚操作。而save命令导出的是镜像，所以导入时可以完整保留每一层layer信息。docker history 镜像id命令可以查询每一层layer信息。")]),s._v(" "),n("li",[s._v("load命令不能对镜像重命名；import命令可以对镜像重命名；")])]),s._v(" "),n("p",[s._v("可以依据具体使用场景来选择命令:")]),s._v(" "),n("ul",[n("li",[s._v("若是只想备份 images，使用 save、load 即可")]),s._v(" "),n("li",[s._v("若是在启动容器后，容器内容有变化，需要备份，则使用export、import")])]),s._v(" "),n("h3",{attrs:{id:"拷贝镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#拷贝镜像"}},[s._v("#")]),s._v(" 拷贝镜像")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# save 命令：保存镜像到本地")]),s._v("\ndocker save "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" images "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("images"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例")]),s._v("\ndocker save -o nginx_docker_image.tar nginx:latest\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\ndocker save "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" nginx_docker_image.tar nginx:latest\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("其中 "),n("strong",[s._v("-o")]),s._v(" 和 "),n("strong",[s._v(">")]),s._v(" 表示输出到文件，nginx_docker_image.tar 为目标文件，nginx:latest 是源镜像名（name:tag）")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# load 命令：从本地文件加载镜像到 docker")]),s._v("\ndocker load "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例")]),s._v("\ndocker load -i nginx_docker_image.tar\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或")]),s._v("\ndocker load "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" nginx_docker_image.tar\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("其中 "),n("strong",[s._v("-i")]),s._v(" 和 "),n("strong",[s._v("<")]),s._v(" 表示从文件输入。会成功导入镜像及相关元数据，包括 tag 信息")]),s._v(" "),n("h3",{attrs:{id:"拷贝容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#拷贝容器"}},[s._v("#")]),s._v(" 拷贝容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# export 命令：导出容器到本地")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" container\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" -o nginx_container_backup.tar nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("其中 "),n("strong",[s._v("-o")]),s._v(" 表示输出到文件，nginx_container_backup.tar 为目标文件，nginx 是源容器名（name）")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# import 命令：从本地文件导入容器到 docker")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("URL"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("REPOSITORY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" nginx_container_backup.tar nginx:latest\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("使用 docker images 命令可以查看是否导入成功，导入成功就可以根据镜像运行容器")]),s._v(" "),n("p",[s._v("导入从容器导出的镜像后，现在它就是一个镜像了，启动则需要根据具体的启动参数来启动，比如：")]),s._v(" "),n("p",[s._v("docker run -d -p 80:80 --restart=always --name=nginx  nginx:latest")])])}),[],!1,null,null,null);a.default=e.exports}}]);